/*! $FileVersion=1.1.224 */ var data_collector_fileVersion = "1.1.224"; 
ModuleManager.set("uptime_tracker",function(){var a=function(){if(GetSetting("Analytics.Integration.Type")=="static"){return{TimeZero:function(){return"[Not available]"},WorkingTime:function(){return"[Not available]"},InternetTime:function(){return"[Not available]"}}}try{var b=getPluginFactory().CreateFromGuid("{CE3C9D0C-B003-4ACA-A273-88AE8B7C6106}");b.GetTimeZero();return{TimeZero:function(){return b.GetTimeZero()},WorkingTime:function(){return b.GetWorkingTimeInSeconds()},InternetTime:function(){return b.GetInternetTimeInSeconds()}}}catch(c){try{b=PluginFromGUID.Create("{CE3C9D0C-B003-4ACA-A273-88AE8B7C6106}");b.Execute("GetTimeZero");return{TimeZero:function(){return b.Execute("GetTimeZero")},WorkingTime:function(){return b.Execute("GetWorkingTimeInSeconds")},InternetTime:function(){return b.Execute("GetInternetTimeInSeconds")}}}catch(c){return{TimeZero:function(){return"[Error creating plugin]"},WorkingTime:function(){return"[Error creating plugin]"},InternetTime:function(){return"[Error creating plugin]"}}}}}();return{fetchFromDataDefinition:function(c){try{return a[c.name]()}catch(b){if(b.hasOwnProperty("message")){return"[Plugin method failed: "+b.message+"]"}else{return"[Plugin method failed]"}}}}}());var Create_data_collector=function(){var a={setup:function(){try{this._logInformation("Setup Started.");this._loadDefinitions();this._farmers=this._createFarmers(this);this._refreshers=this._createRefreshers(this);if(!this._farmers||!this._refreshers||!this._definitions){this._logError("Setup failed: farmers("+this._farmers+"). refreshers("+this._refreshers+"). definitions("+this._definitions+")");return}var c=[];for(var b in this._definitions){c.push(b)}this.markDataExpired(c);this._logInformation("Setup Done.")}catch(d){this._logError("Setup failed: "+d.message)}},get:function(h){try{var g=null;if(typeof h==="string"){g=h;h=[h]}if(!h instanceof Array){this._logError("get: itemsList not an array ("+h+").");return{}}var f=this._getCommonElements(this._expiredItems,h);this._updateCache(f,false);var b=this._getCommonElements(this._operationExpiredItems,h);this._updateCache(b,true);var d=this._createCollection(h);return g?d[g]:d}catch(c){this._logError("get: "+c.message);return{}}},markDataExpired:function(f){try{this._logDebug("Marking items as expired: "+JSON.stringify(f));if(typeof f==="string"){f=[f]}if(!f instanceof Array){this._logError("markDataExpired: itemsList not an array ("+f+").");return}for(var b in f){if(this._arrayIncludes(this._expiryQueue,f[b])){this._logError("Circular dependency detected for "+f[b]);return}}for(var b in f){var c=f[b];if(!this._arrayIncludes(this._expiredItems,c)){this._expiryQueue.push(c);try{if(this._definitions[c]["source"]=="dataCollector"){this._logDebug("Marking parent items expired for ("+c+")");this.markDataExpired(this._definitions[c]["params"])}}catch(d){this._logError("Exception when marking parent keys expired for ("+c+")")}this._expiredItems.push(c);this._removeItemFromArray(this._expiryQueue,c)}}}catch(d){this._logError("markDataExpired: "+d.message)}},markDataOperationExpired:function(f){try{this._logInformation("Marking items as operation expired: "+JSON.stringify(f));if(typeof f==="string"){f=[f]}if(!f instanceof Array){this._logError("markDataOperationExpired: itemsList not an array ("+f+").");return}for(var b in f){var c=f[b];if(!this._arrayIncludes(this._operationExpiredItems,c)){this._operationExpiredItems.push(c)}}}catch(d){this._logError("markDataOperationExpired: "+d.message)}},notifyMsg:function(d){try{this._logInformation("notifyMsg: New msg("+d+")");var b=this._subscribedMsgs[d];if(!b){return false}this.markDataExpired(b);return true}catch(c){this._logError("notifyMsg: "+c.message)}},isExpired:function(d){try{if(typeof d==="string"){d=[d]}if(!d instanceof Array){this._logError("isExpired: itemsList not an array ("+d+").");return false}var c=this._getCommonElements(this._expiredItems,d);return(c.length===0)?false:true}catch(b){this._logError("isExpired: "+b.message);return false}},_createCollection:function(g){try{var f={};for(var b in g){var c=g[b];f[c]=(this._cache[c]!==undefined)?this._cache[c]:"[unknown]"}return f}catch(d){this._logError("_createCollection: "+d.message);return{}}},_subscribeToMsgBusRefreshMsgs:function(d,f){try{if(!d){this._logError("_subscribeToMsgBusRefreshMsgs: Called with no name provided");return}if(!f||f.length===0){return}this._logInformation("_subscribeToMsgBusRefreshMsgs: Subscribing for ("+d+"). msgs:"+JSON.stringify(f));for(var c in f){try{var h=f[c];if(!this._subscribedMsgs[h]){this._subscribedMsgs[h]=[];var b=getMessageBus();b.Subscribe(h)}if(!this._arrayIncludes(this._subscribedMsgs[h],d)){this._subscribedMsgs[h].push(d)}}catch(g){this._logError("_subscribeToMsgBusRefreshMsgs:loop: "+g.message)}}}catch(g){this._logError("_subscribeToMsgBusRefreshMsgs: "+g.message)}},_loadDefinitions:function(){try{var b=JSONManager.getSingleton("data_items");this._definitions=b.data}catch(c){this._logError("_loadDefinitions: Exception loading data_items: "+c.message)}},_updateCache:function(f,c){if(!(f instanceof Array)){this._logError("loadToStore: itemsList not an array ("+f+").");return}if(f.length===0){return}for(var b in f){try{this._loadSingleItem(f[b],c)}catch(d){this._logError("_updateCache: Issue with loading singleItem for ("+f[b]+")")}}},_loadSingleItem:function(g,b){var c=this._definitions[g];if(!c){this._logError("loadItem: No item definition found for ("+g+")");this._cache[g]="[unknown]";return}if(!b){this._harvest(g,c)}var f=this._processOperation(g,c.operationConfig);var h=ModuleManager.getSingleton("rules");var d=h.apply(f,c.rule);this._cache[g]=d;this._setRefreshers(g,c.refresh)},_harvest:function(d,b){try{this._logInformation("_harvest: Harvesting("+d+")");if(this._arrayIncludes(this._harvestQueue,d)){this._rawDataStore[d]=null;this._removeItemFromArray(this._expiredItems,d);this._logError("_harvest: Circular dependency detected for ("+d+")");return}if(this._farmers[b.source]===null){this._logError("_harvest: Unknown harvesting function ("+b.source+")");this._rawDataStore[d]=null;return}this._harvestQueue.push(d);var c=this._farmers[b.source](b.params);this._rawDataStore[d]=c;this._removeItemFromArray(this._expiredItems,d);this._removeItemFromArray(this._harvestQueue,d)}catch(f){this._logError("_harvest: "+f.message)}},_processOperation:function(g,c){var d=this._rawDataStore[g];var b=ModuleManager.getSingleton("operations");var f=b.apply(d,c);this._removeItemFromArray(this._operationExpiredItems,g);return f},_setRefreshers:function(d,b){if(!b){return}for(var c in b){try{this._refreshers[c](d,b[c])}catch(f){this._logError("_setRefreshers: "+f.message)}}},_retrieveFromDataStore:function(h){try{this._logInformation("Requesting item from data_collector: "+JSON.stringify(h));if(typeof h==="string"){var c=this.get(h);return c}var c=[];var f=this.get(h);if(!f){return[]}for(var b in h){var d=h[b];c.push(f[d])}return c}catch(g){this._logError("_retrieveFromDataStore: "+g.message)}},_requestFromMsgBus:function(g){try{this._logInformation("Requesting item from Msgbus: "+JSON.stringify(g));if(typeof g!="object"){logError("_requestFromMsgBus: params not an object!");return null}var c=getMessageBus();if(!c){logError("Current MsgBus Plugin does not support request/response.");return null}var b=c.Request(g.name,g.data);var f=JSON.parse(b);return f.payload}catch(d){this._logError("_requestFromMsgBus: "+d.message)}},_createRefreshers:function(c){var b={harvestIfEq:function(f,d){if(c._cache[f]===d){c.markDataExpired(f)}},harvestTimeout:function(f,d){setTimeout(d,function(){c.markDataExpired(f)})},operationTimeout:function(f,d){setTimeout(d,function(){c.markDataOperationExpired(f)})},onMessageBusMsg:function(f,d){c._subscribeToMsgBusRefreshMsgs(f,d)}};return b},_harvestConfigVersions:function(d){try{var c=JSONManager.getSingleton(d);return c.version}catch(b){this._logError("_harvestConfigVersions: "+e.message+" for "+d)}return null},_createFarmers:function(c){var b={UWPStorage:function(d){var f=ModuleManager.getSingleton("uwp_storage");return f.get(d)},UptimeTracker:function(f){var d=ModuleManager.getSingleton("uptime_tracker");return d.fetchFromDataDefinition(f)},registry:function(f){var d=ModuleManager.getSingleton("registry");return d.fetchFromDataDefinition(f)},registryCustom:function(f){var d=ModuleManager.getSingleton("registry");return d.executeAction(f)},csp:function(f){var d=ModuleManager.getSingleton("csp_client");return d.fetchFromDataDefinition(f)},subdb:function(f){var d=ModuleManager.getSingleton("subdb");return d.fetchFromDataDefinition(f)},wmi:function(d){var f=ModuleManager.getSingleton("wmi");return f.fetchFromDataDefinition(d)},dataCollector:function(d){return c._retrieveFromDataStore(d)},dataAggregator:function(f){var d=ModuleManager.getSingleton("dataset_da");return d.get(f)},fileVersion:function(f){var g=getSystemPlugin();var d=g.GetKnownFolder(f);if(!d){return null}return g.GetFileVersion(d)},fileVersionEx:function(h){var g=h.directory;var f=h.file;var i=getSystemPlugin();var d=i.GetKnownFolder(g);if(!d){return null}d+="\\"+f;return i.GetFileVersion(d)},creationDate:function(d){var f=ModuleManager.getSingleton("wmi");return f.getTargetPathCreationDate(d)},wmiCustom:function(d){var f=ModuleManager.getSingleton("wmi");return f.executeAction(d)},transportStatus:function(j){try{var f=JSONManager.getSingleton("profile");var d=f.data;if(!d){return null}var i=d[j];if(!i){c._logError("transportStatus:: No such profile("+j+")");return null}var g=createEmitter(j,i);return g._isEnabled()?true:false}catch(h){c._logError("transportStatus: "+h.message)}},settingsManager:function(d){return StorageManager.get(d)},msgBusSource:function(d){return c._requestFromMsgBus(d)},iniFile:function(d){return GetKeyValueFromINIFile(d)},aleSetting:function(d){return GetSetting(d)},configVersionHarvester:function(d){return c._harvestConfigVersions(d)}};return b},_logInformation:function(b){logInformation("data_collector: "+b)},_logError:function(b){logError("data_collector: "+b)},_logDebug:function(b){logDebug("data_collector: "+b)},_farmers:null,_refreshers:{},_harvestQueue:[],_expiredItems:[],_expiryQueue:[],_operationExpiredItems:[],_rawDataStore:{},_cache:{},_definitions:{},_subscribedMsgs:{},_arrayIncludes:function(d,c){for(var b in d){if(c==d[b]){return true}}return false},_getCommonElements:function(f,d){var b=[];for(var c in f){if(this._arrayIncludes(d,f[c])){b.push(f[c])}}return b},_removeItemFromArray:function(d,c){for(var b in d){if(c==d[b]){d.splice(b,1);break}}}};a.setup();return a};ModuleManager.registerFactory("data_collector",Create_data_collector);
//795C58C4F373DA146181AAAE7A318FD8D06F82C2AF87D488CB4BD81E0BCB279B4920CE98E0F1B33489C86C8CE8CC8ED74D429D36F607CD436B51874B8F398924++